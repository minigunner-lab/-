<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WOW Madness</title>
  <style>
    body {
      margin: 0;
      background: #222;
      color: #eee;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow-x: hidden;
    }
    .wrapper {
      max-width: 800px;
      margin: 20px auto;
      padding: 10px;
      background: #333;
      border-radius: 10px;
      min-height: 400px;
      position: relative;
    }
    .neck {
      background: #444;
      margin: 10px 0;
      padding: 15px;
      border-radius: 8px;
      user-select: none;
      white-space: pre-line;
      font-weight: bold;
    }
    .textwow {
      position: absolute;
      font-size: 20px;
      font-weight: 900;
      color: #f5d742;
      text-shadow: 1px 1px 3px #000;
      pointer-events: auto;
      cursor: pointer;
      user-select: none;
      animation: floatUp 3s ease forwards;
    }
    @keyframes floatUp {
      0% {opacity: 1; transform: translateY(0);}
      100% {opacity: 0; transform: translateY(-150px);}
    }
    .largewow {
      position: absolute;
      font-size: 60px;
      font-weight: 900;
      color: #ff4081;
      text-shadow: 2px 2px 5px #000;
      pointer-events: none;
      user-select: none;
      animation: floatUp 5s ease forwards;
      left: 50%;
      transform: translateX(-50%);
    }
    .hidden {
      display: none;
    }
    #length, #wows, #largeWows, #rainbow, #dogeprime, #secretwow, #fibo {
      font-weight: 900;
      font-size: 1.2em;
      margin-left: 10px;
      color: #ffcc00;
    }
    .rainbow {
      animation: rainbowColors 2s infinite;
    }
    @keyframes rainbowColors {
      0%,100%{color: #f00}
      20%{color: #ff0}
      40%{color: #0f0}
      60%{color: #0ff}
      80%{color: #00f}
    }
    .print {
      cursor: pointer;
      background: #555;
      padding: 10px 15px;
      border-radius: 5px;
      margin: 20px 0;
      display: inline-block;
      user-select: none;
    }
    .secretwow {
      color: #00ff99;
      font-weight: 900;
      cursor: pointer;
      user-select: none;
    }
    .secretwow.found {
      text-decoration: line-through;
      color: #666;
    }
    .spinLeft {
      animation: spinLeft 1.5s linear infinite;
    }
    .spinRight {
      animation: spinRight 1.5s linear infinite;
    }
    @keyframes spinLeft {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(-360deg);}
    }
    @keyframes spinRight {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }
    .head {
      font-size: 2em;
      margin-bottom: 10px;
    }
    .hatted {
      display: none;
      font-size: 2em;
      color: #ff69b4;
      font-weight: 900;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <div class="wrapper">
    <div class="head">WOW Counter: <span id="wows">0</span></div>
    <div>Length Status: <span id="length">0</span></div>
    <div>Large WOWs: <span id="largeWows">0</span></div>
    <div>Rainbow WOWs: <span id="rainbow">0</span></div>
    <div>Doge Prime: <span id="dogeprime">INACTIVE</span></div>
    <div>Secret WOWs Found: <span id="secretwow">0</span></div>
    <div>Fibonacci Challenge: <span id="fibo">INACTIVE</span></div>

    <button class="print">Print the WOWs!</button>

    <div id="largewowcontainer" class="hidden">üåü Large WOW Container Active! üåü</div>
    <div id="rainbowwowcontainer" class="hidden">üåà Rainbow WOW Container Active! üåà</div>
    <div id="dogeprimecontainer" class="hidden">üêï Doge Prime Container Active! üêï</div>
    <div id="secretwowcontainer" class="hidden">üîí Secret WOW Container Active! üîí</div>
    <div id="fibowowcontainer" class="hidden">üåÄ Fibonacci WOW Challenge Started! üåÄ</div>

    <div class="neck">
WOW
WOW
WOW
WOW
WOW
WOW
WOW
WOW
WOW
WOW
    </div>
  </div>

<script>
/* --- FULL JS WRAPPER FROM YOUR PREVIOUS MESSAGE, INCLUDING ALL FUNCTIONS --- */

const wrapper = document.querySelector(".wrapper")
const neck = document.querySelector(".neck")
const wowEl = document.querySelector("#wows")

const largeWowContainer = document.querySelector("#largewowcontainer")
const rainbowWowContainer = document.querySelector("#rainbowwowcontainer")
const dogePrimeContainer = document.querySelector("#dogeprimecontainer")
const secretWowContainer = document.querySelector("#secretwowcontainer")
const fibowowcontainer = document.querySelector("#fibowowcontainer")

const largewowEl = document.querySelector("#largeWows")
const lengthEl = document.querySelector("#length")
const rainbowsEl = document.querySelector("#rainbow")
const dogePrimeEl = document.querySelector("#dogeprime")
const secretWowEl = document.querySelector("#secretwow")
const fiboWowEl = document.querySelector("#fibo")

let wows = 0
let largewows = 0
let rainbowwows = 0
let secretwows = 0
let minidoges = 0
const primeWows = []
const largeWowsRequired = 10

let fibonacciChallengeStarted = false
let fibonacciChallengeComplete = false
const fibonacciWows = []
const fibonacciSecretWows = []
let dogePrime = false

document.querySelector(".print").addEventListener("click", () => {
  if (fibonacciChallengeComplete) {
    document.querySelector(".head").style.display = "none"
    document.querySelector(".hatted").style.display = "block"
  }
  window.print()
})

const observer = new IntersectionObserver(
  (entries, observer) => {
    entries.forEach((entry) => {
      if (entry.intersectionRatio > 0) {
        injectNeck(entry)
      }
    })
  },
  { rootMargin: "0px 0px 200% 0px" }
)

document.addEventListener("click", onBodyClick)

window.onscroll = function(ev) {
  if (window.innerHeight + window.pageYOffset >= document.body.offsetHeight) {
    const lastEl = document.querySelector(".neck:last-child")
    injectNeck({ target: lastEl })
  }
}

function injectNeck(entry) {
  observer.unobserve(entry.target)

  const clonedNeck = neck.cloneNode(true)
  wrapper.appendChild(clonedNeck)
  observer.observe(clonedNeck)

  injectWow()
}

function injectWow() {
  wows++
  wowEl.innerText = wows

  const newWow = document.createElement("div")
  newWow.className = "textwow"
  newWow.innerText = "WOW"
  newWow.style.left = 100 + Math.random() * (window.innerWidth - 300) + "px"
  newWow.style.top = wrapper.offsetHeight - 200 + "px"
  document.body.appendChild(newWow)

  if (isPrime(wows)) {
    primeWows.push(newWow)
  }

  if (isFibonacci(wows)) {
    fibonacciWows.push(newWow)
  }

  if (wows === 10) lengthEl.innerText = "wow wow"
  if (wows === 50) lengthEl.innerText = "wow wow wow"
  if (wows === 100) lengthEl.innerText = "much wow"
  if (wows === 150) lengthEl.innerText = "long much wow"
  if (wows === 250) lengthEl.innerText = "very long much wow"
  if (wows === 500) lengthEl.innerText = "wow very long much wow"
  if (wows === 1000) lengthEl.innerText = "much wow very long much wow!"
  if (wows === 2000) lengthEl.innerText = "much wow very long much wow!!"
  if (wows === 3000) lengthEl.innerText = "much wow very long much wow!!!"
  if (wows === 5000) lengthEl.innerText = "!!much wow very long much wow!!"
  if (wows === 10000) lengthEl.innerText = "many many wow amaze"
  if (wows === 30000) lengthEl.innerText = "amaze wow dont forget to print!"
  if (wows === 50000) lengthEl.innerText = "wowwowowowowowowowowowowwoow"
  if (wows === 80000) lengthEl.innerText = "wowwowowowowowowowowowowwooweeeeeeeeee"

  if (wows > 200 && Math.random() > 0.99) {
    injectLargeWow()
  }
}

function injectLargeWow() {
  largewows++
  largewowEl.innerText = largewows

  largeWowContainer.classList.remove("hidden")

  const newWow = document.createElement("div")
  newWow.className = "largewow"
  newWow.innerText = "WOW"
  newWow.style.left = "50%"
  newWow.style.top = wrapper.offsetHeight - 200 + "px"
  document.body.appendChild(newWow)

  if (largewows === largeWowsRequired) {
    rainbowWowContainer.classList.remove("hidden")
    dogePrimeContainer.classList.remove("hidden")
  }
}

function isPrime(n) {
  if (n < 2) return false
  const q = Math.floor(Math.sqrt(n))

  for (let i = 2; i <= q; i++) {
    if (n % i == 0) {
      return false
    }
  }

  return true
}

function isSquare(n) {
  return n > 0 && Math.sqrt(n) % 1 === 0
}

function isFibonacci(numberToCheck) {
  return (
    isSquare(5 * numberToCheck * numberToCheck + 4) ||
    isSquare(5 * numberToCheck * numberToCheck - 4)
  )
}

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1))
    ;[array[i], array[j]] = [array[j], array[i]]
  }
}

function onBodyClick(e) {
  if (e.target.className === "textwow" && largewows >= largeWowsRequired) {
    rainbowwows++
    e.target.classList.add("rainbow")

    rainbowsEl.innerText = rainbowwows

    let count = 0
    let isPrimeActive = primeWows.every((wowEl) => {
      count++
      return wowEl.classList.contains("rainbow")
    })

    if (dogePrime === false && isPrimeActive === true) {
      dogePrime = true
      dogePrimeEl.innerText = "ACTIVE"
      setupSecretWows()
    } else if (count !== primeWows.length) {
      dogePrimeEl.innerText = "INACTIVE (" + count + '/' + primeWows.length + ")"
    }
  }

  if (e.target.className === "secretwow") {
    e.target.classList.add("found")
    secretwows++
    secretWowEl.innerText = secretwows

    if (secretwows === 100) {
      fibonacciChallengeStarted = true
      fibowowcontainer.classList.remove("hidden")
    }
  }

  if (fibonacciChallengeStarted) {
    if (
      e.target.classList.contains("textwow") ||
      e.target.classList.contains("secretwow")
    ) {
      if (e.target.classList.contains("spinLeft")) {
        e.target.classList.remove("spinLeft")
        e.target.classList.add("spinRight")
      } else if (e.target.classList.contains("spinRight")) {
        e.target.classList.remove("spinRight")
        e.target.classList.add("spinLeft")
      } else {
        e.target.classList.add("spinLeft")
      }

      checkAllFiboWows()
    }
  }
}

function checkAllFiboWows() {
  let successConfirmed = true
  let innerText = 'INACTIVE '

  let right = true
  let chainOfLengthRegular = 0
  for (let i = 0; i < fibonacciWows.length; i++) {
    if (fibonacciWows[i].classList.contains(right ? "spinRight" : "spinLeft")) {
      right = !right
      chainOfLengthRegular++
    } else {
      successConfirmed = false
      break
    }
  }

  innerText += "\n (" + chainOfLengthRegular + '/' + fibonacciWows.length + ') Regular (LRL) \n'

  right = false
  let chainofLengthSecret = 0
  for (let i = 0; i < fibonacciSecretWows.length; i++) {
    if (
      fibonacciSecretWows[i].classList.contains(
        right ? "spinRight" : "spinLeft"
      )
    ) {
      chainofLengthSecret++
      right = !right
    } else {
      successConfirmed = false
      break
    }
  }

  innerText += "(" + chainofLengthSecret + '/' + fibonacciSecretWows.length + ') Secret (RLR)'

  if (successConfirmed) {
    fibonacciChallengeComplete = true
    fiboWowEl.innerText = "COMPLETE (NOW PRINT!)"
  } else {
    fibonacciChallengeComplete = false
    fiboWowEl.innerText = innerText
  }
}

function setupSecretWows() {
  secretWowContainer.classList.remove("hidden")

  const allnecks = document.querySelectorAll(".neck")
  let allnecksAsArray = Array.apply(null, allnecks)
  allnecksAsArray.shift() // remove first item

  shuffleArray(allnecksAsArray)
  shuffleArray(allnecksAsArray)

  let total = 100

  for (let i = 0; i < total; i++) {
    let neckItem = allnecksAsArray[i]
    let pieces = neckItem.innerText.split("\n")
    const pieceIndex = Math.floor(Math.random() * (pieces.length - 1))
    const injectionIndex = 5 + Math.floor(Math.random() * 18)
    pieces[pieceIndex] =
      pieces[pieceIndex].slice(0, injectionIndex) +
      '<span class="secretwow">WOW</span>' +
      pieces[pieceIndex].slice(injectionIndex + 3)
    neckItem.innerHTML = pieces.join("\n")
  }

  const allSecretwows = document.querySelectorAll(".secretwow")
  const secretWowsAsArray = Array.apply(null, allSecretwows)
  for (let i = 0; i < secretWowsAsArray.length; i++) {
    if (isFibonacci(i + 1)) {
      fibonacciSecretWows.push(secretWowsAsArray[i])
    }
  }
}

observer.observe(neck)
</script>

</body>
</html>
